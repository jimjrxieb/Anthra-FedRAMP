apiVersion: constraints.gatekeeper.sh/v1beta1
kind: K8sNetworkBoundaries
metadata:
  name: novasec-network-boundaries
  annotations:
    novasec.cloud/control: SC-7
    description: >-
      Enforce network boundary protection via default-deny NetworkPolicy
      and block NodePort/LoadBalancer services.
      NIST SC-7: Monitor and control communications at external boundaries.
spec:
  enforcementAction: deny
  match:
    kinds:
      - apiGroups: [""]
        kinds: ["Namespace", "Service"]
    excludedNamespaces:
      - kube-system
      - kube-public
      - kube-node-lease
      - gatekeeper-system
  parameters:
    blockedServiceTypes:
      - NodePort
      - LoadBalancer
