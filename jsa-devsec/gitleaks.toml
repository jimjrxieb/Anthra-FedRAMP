# Gitleaks configuration for NovaSec Cloud FedRAMP Moderate
# NIST Controls: IA-5 (Authenticator Management)

title = "NovaSec Cloud Secret Detection"

[allowlist]
description = "NovaSec Cloud allowlisted patterns"
paths = [
    '''(^|\/)\.git\/''',
    '''(^|\/)vendor\/''',
    '''(^|\/)node_modules\/''',
    '''\.lock$''',
    '''\.sum$''',
    '''target-app\/.*\.sql$''',  # DVWA demo SQL â€” contains test creds by design
]
regexTarget = "match"

# Custom rules for NovaSec Cloud stack
[[rules]]
id = "novasec-aws-access-key"
description = "AWS Access Key ID"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["aws", "credentials", "nist-ia-5"]

[[rules]]
id = "novasec-aws-secret-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws_secret_access_key\s*=\s*[A-Za-z0-9/+=]{40}'''
tags = ["aws", "credentials", "nist-ia-5"]

[[rules]]
id = "novasec-generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|apikey)\s*[:=]\s*["']?[A-Za-z0-9_\-]{20,}["']?'''
tags = ["api-key", "nist-ia-5"]

[[rules]]
id = "novasec-jwt-token"
description = "JWT Token"
regex = '''eyJ[A-Za-z0-9_-]{10,}\.eyJ[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}'''
tags = ["jwt", "token", "nist-ia-5"]

[[rules]]
id = "novasec-private-key"
description = "Private Key Header"
regex = '''-----BEGIN (RSA |EC |DSA )?PRIVATE KEY-----'''
tags = ["private-key", "nist-ia-5"]

[[rules]]
id = "novasec-database-url"
description = "Database Connection String"
regex = '''(?i)(postgres|mysql|mongodb|redis):\/\/[^\s'"]+@[^\s'"]+'''
tags = ["database", "credentials", "nist-ia-5"]

[[rules]]
id = "novasec-slack-webhook"
description = "Slack Webhook URL"
regex = '''https:\/\/hooks\.slack\.com\/services\/T[A-Z0-9]+\/B[A-Z0-9]+\/[A-Za-z0-9]+'''
tags = ["slack", "webhook", "nist-ia-5"]
